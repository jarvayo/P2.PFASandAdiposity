#####                                                       #####
##### EVALUATE DISTRIBUTION OF VARIABLES AND CREATE TABLE 1 #####
#####                                                       #####

```{r}
##### LOAD PACKAGES
library("tidyverse")
library("dplyr")
library("table1")
library("gtools")
library("corrplot")
library("Hmisc")

```

```{r}
##### LOAD DATASET
PFAS_A <-read.csv("C:/Users/jarva/Desktop/James-Todd Lab/PFASandAdiposity/Data/PFAS_A_COMP.csv")
PFAS_AD <-read.csv("C:/Users/jarva/Desktop/James-Todd Lab/PFASandAdiposity/Data/PFAS_AD_COMP.csv")
PFAS_X <-read.csv("C:/Users/jarva/Desktop/James-Todd Lab/PFASandAdiposity/Data/PFAS_X.csv")

```

```{r}
##### LOG-TRANSFORM PFAS TO OBSERVE SHAPE OF DISTRIBUTION
PFAS_A$LNPFOS <- log(PFAS_A$PFOS)
PFAS_A$LNPFOA <- log(PFAS_A$PFOA)
PFAS_A$LNPFNA2 <- log(PFAS_A$PFNA2)
PFAS_A$LNPFHxS <- log(PFAS_A$PFHxS)
PFAS_A$LNME_PFOSA <- log(PFAS_A$Me_PFOSA_AcOH2)
PFAS_A$LNET_PFOSA <- log(PFAS_A$Et_PFOSA_AcOH)

PFAS_AD$LNPFOS <- log(PFAS_AD$PFOS)
PFAS_AD$LNPFOA <- log(PFAS_AD$PFOA)
PFAS_AD$LNPFNA2 <- log(PFAS_AD$PFNA2)
PFAS_AD$LNPFHxS <- log(PFAS_AD$PFHxS)
PFAS_AD$LNME_PFOSA <- log(PFAS_AD$Me_PFOSA_AcOH2)
PFAS_AD$LNET_PFOSA <- log(PFAS_AD$Et_PFOSA_AcOH)


##### LOG-TRANSFORM DXA MEASURES (AND BMI/WEIGHT GAIN/WAIST CIRCUMFERENCE) TO OBSERVE SHAPE OF DISTRIBUTION
PFAS_A$LNBMI <- log(PFAS_A$mom_bmi_MT)
PFAS_A$LNWAIST <- log(PFAS_A$mom_waist_ma17)
PFAS_A$LNHIP <- log(PFAS_A$mom_hip_ma17)
PFAS_A$LNBFAT <- log(PFAS_A$mom_bodyfat_ma17)
PFAS_A$LNFAT <- log(PFAS_A$mom_fat_ma17)
PFAS_A$LNWT <- log(PFAS_A$mom_weight_ma17)

PFAS_AD$LNVAT_AREA <- log(PFAS_AD$VAT_AREA_mdxa17)
PFAS_AD$LNSAT_AREA <- log(PFAS_AD$SAT_AREA_mdxa17)
PFAS_AD$LNTAT_AREA <- log(PFAS_AD$TAT_AREA_mdxa17)
PFAS_AD$LNVAT_MASS <- log(PFAS_AD$VAT_MASS_mdxa17)
PFAS_AD$LNSAT_MASS <- log(PFAS_AD$SAT_MASS_mdxa17)
PFAS_AD$LNTAT_MASS <- log(PFAS_AD$TAT_MASS_mdxa17)
PFAS_AD$LNVAT_VOLUME <- log(PFAS_AD$VAT_VOLUME_mdxa17)
PFAS_AD$LNSAT_VOLUME <- log(PFAS_AD$SAT_VOLUME_mdxa17)
PFAS_AD$LNTAT_VOLUME <- log(PFAS_AD$TAT_VOLUME_mdxa17)
PFAS_AD$LNWT <- log(PFAS_AD$WEIGHT_mdxa17)
PFAS_AD$LNBMI <- log(PFAS_AD$mom_bmi_MT)
PFAS_AD$LNWAIST <- log(PFAS_AD$mom_waist_ma17)
PFAS_AD$LNHIP <- log(PFAS_AD$mom_hip_ma17)
PFAS_AD$LNBFAT <- log(PFAS_AD$mom_bodyfat_ma17)
PFAS_AD$LNFAT <- log(PFAS_AD$mom_fat_ma17)

```

```{r}
##### DESCRIBE PFAS DISTRIBUTION, ANTHRO DATASET
hist(PFAS_A$PFOS)
hist(PFAS_A$PFOA)
#hist(PFAS_A$PFOSA)
hist(PFAS_A$PFNA2)
hist(PFAS_A$PFHxS)
#hist(PFAS_A$PFDeA)
hist(PFAS_A$Me_PFOSA_AcOH2)
hist(PFAS_A$Et_PFOSA_AcOH)

# DESCRIBE LNPFAS DISTRIBUTION, ANTHRO DATASET
hist(PFAS_A$LNPFOS)
hist(PFAS_A$LNPFOA)
#hist(PFAS_A$LNPFOSA)
hist(PFAS_A$LNPFNA2)
hist(PFAS_A$LNPFHxS)
#hist(PFAS_A$LNPFDeA)
hist(PFAS_A$LNME_PFOSA)
hist(PFAS_A$LNET_PFOSA)


##### DESCRIBE PFAS DISTRIBUTION, ANTHRO + DXA DATASET
hist(PFAS_AD$PFOS)
hist(PFAS_AD$PFOA)
#hist(PFAS_AD$PFOSA)
hist(PFAS_AD$PFNA2)
hist(PFAS_AD$PFHxS)
#hist(PFAS_AD$PFDeA)
hist(PFAS_AD$Me_PFOSA_AcOH2)
hist(PFAS_AD$Et_PFOSA_AcOH)

# DESCRIBE LNPFAS DISTRIBUTION, ANTHRO + DXA DATASET
hist(PFAS_AD$LNPFOS)
hist(PFAS_AD$LNPFOA)
#hist(PFAS_AD$LNPFOSA)
hist(PFAS_AD$LNPFNA2)
hist(PFAS_AD$LNPFHxS)
#hist(PFAS_AD$LNPFDeA)
hist(PFAS_AD$LNME_PFOSA)
hist(PFAS_AD$LNET_PFOSA)

```

```{r}
##### DESCRIBE DISTRIBUTION OF OUTCOME MEASURES, ANTHRO DATASET
hist(PFAS_A$mom_bmi_MT)
hist(PFAS_A$mom_waist_ma17)
hist(PFAS_A$mom_hip_ma17)
hist(PFAS_A$mom_bodyfat_ma17)
hist(PFAS_A$mom_fat_ma17)
hist(PFAS_A$mom_weight_ma17)

# DESCRIBE THE LOG-DISTRIBUTION OF OUTCOME MEASURES, ANTHRO DATASET
hist(PFAS_A$LNBMI)
hist(PFAS_A$LNWAIST)
hist(PFAS_A$LNHIP)
hist(PFAS_A$LNBFAT)
hist(PFAS_A$LNFAT)
hist(PFAS_A$LNWT)


##### DESCRIBE DISTRIBUTION OF OUTCOME MEASURES, ANTHRO + DXA DATASET
hist(PFAS_AD$VAT_AREA_mdxa17)
hist(PFAS_AD$SAT_AREA_mdxa17)
hist(PFAS_AD$TAT_AREA_mdxa17)
hist(PFAS_AD$VAT_MASS_mdxa17)
hist(PFAS_AD$SAT_MASS_mdxa17)
hist(PFAS_AD$TAT_MASS_mdxa17)
hist(PFAS_AD$VAT_VOLUME_mdxa17)
hist(PFAS_AD$SAT_VOLUME_mdxa17)
hist(PFAS_AD$TAT_VOLUME_mdxa17)
hist(PFAS_AD$mom_bmi_MT)
hist(PFAS_AD$mom_waist_ma17)
hist(PFAS_AD$mom_hip_ma17)
hist(PFAS_AD$mom_bodyfat_ma17)
hist(PFAS_AD$mom_fat_ma17)
hist(PFAS_AD$mom_weight_ma17)

# DESCRIBE THE LOG-DISTRIBUTION OF OUTCOME MEASURES, ANTHRO + DXA DATASET
hist(PFAS_AD$LNVAT_AREA)
hist(PFAS_AD$LNSAT_AREA)
hist(PFAS_AD$LNTAT_AREA)
hist(PFAS_AD$LNVAT_MASS)
hist(PFAS_AD$LNSAT_MASS)
hist(PFAS_AD$LNTAT_MASS)
hist(PFAS_AD$LNVAT_VOLUME)
hist(PFAS_AD$LNSAT_VOLUME)
hist(PFAS_AD$LNTAT_VOLUME)
hist(PFAS_AD$LNWT)
hist(PFAS_AD$LNBMI)
hist(PFAS_AD$LNWAIST)
hist(PFAS_AD$LNHIP)
hist(PFAS_AD$LNBFAT)
hist(PFAS_AD$LNFAT)

```

```{r}
##### ANTHRO DATASET #####

##### RENAME
PFAS_A$age_enroll <- PFAS_A$age_mom_enroll_d
PFAS_A$age_fu <- (PFAS_A$mom_age_days_comp_d_ma17)/365
PFAS_A$fu_time <- (PFAS_A$age_days_comp_d_ma17)/365
PFAS_A$race <- PFAS_A$race2_mom_epi_epia_d
PFAS_A$edu <- PFAS_A$coll_grad
PFAS_A$bmi <- PFAS_A$bmi_mom_prepreg_d
PFAS_A$smoke <- PFAS_A$smokpreg_final_d
PFAS_A$income <- PFAS_A$gt70k
PFAS_A$parity <- PFAS_A$parity_d
PFAS_A$married <- PFAS_A$married_cohab


##### RE-LABEL 
PFAS_A$race <- ifelse(PFAS_A$race == "white", 0,
                     ifelse(PFAS_A$race == "black", 1,
                     ifelse(PFAS_A$race == "hispa", 2,
                     ifelse(PFAS_A$race == "asian", 3,
                     ifelse(PFAS_A$race == "other", 4, 4)))))
PFAS_A$edu <- ifelse(PFAS_A$edu == 1, 1, 0)
PFAS_A$bmi_cat <- ifelse(PFAS_A$bmi <18.5, 0,
                         ifelse(PFAS_A$bmi >=18.5 & PFAS_A$bmi < 25.0, 1, 
                         ifelse(PFAS_A$bmi >=25.0 & PFAS_A$bmi < 30.0, 2, 
                         ifelse(PFAS_A$bmi >=30.0 & PFAS_A$bmi < 35.0, 3,
                         ifelse(PFAS_A$bmi >=35.0, 4, 99)))))
PFAS_A$smoke <- ifelse(PFAS_A$smoke == "former", 0,
                         ifelse(PFAS_A$smoke == "smoke preg", 1,
                         ifelse(PFAS_A$smoke == "xnever", 2, 2)))
PFAS_A$income <- ifelse(PFAS_A$income == 1, 1, 0)
PFAS_A$parity <- ifelse(PFAS_A$parity == 0, 0,
                        ifelse(PFAS_A$parity == 1, 1,
                        ifelse(PFAS_A$parity > 1, 2, 0)))
PFAS_A$married <- ifelse(PFAS_A$married == 1, 1, 0)


##### REFACTOR
PFAS_A$race <- factor(PFAS_A$race,
                        levels = c(0, 1, 2, 3, 4),
                        labels = c("White", "Black", "Hispanic", "Asian", "Other/More than 1 race"))
PFAS_A$edu <- factor(PFAS_A$edu,
                       levels = c(0, 1),
                       labels = c(" < college degree", ">= college degree"))
PFAS_A$bmi_cat <- factor(PFAS_A$bmi_cat,
                       levels = c(0, 1, 2, 3, 4),
                       labels = c("Underweight (< 18.5)", "Normal weight (18.5 to 24.9)", 
                                  "Overweight (25.0 to 29.9)", "Obese (30.0 to 34.9)", 
                                  "Extremely obese (>= 35)"))
PFAS_A$smoke <- factor(PFAS_A$smoke,
                         levels = c(0, 1, 2),
                         labels = c("Former smoker", "Smoked during pregnancy", "Never smoked"))
PFAS_A$income <- factor(PFAS_A$income,
                       levels = c(0, 1),
                       labels = c(" <= $70,000", "> $70,000"))
PFAS_A$parity <- factor(PFAS_A$parity,
                          levels = c(0, 1, 2),
                          labels = c("0", "1", ">= 2"))
PFAS_A$married <- factor(PFAS_A$married,
                          levels = c(0, 1),
                          labels = c("No", "Yes"))

##### LABEL
label(PFAS_A$age_enroll) <- "Maternal age at enrollment"
label(PFAS_A$age_fu) <- "Maternal age at follow-up"
label(PFAS_A$fu_time) <- "Follow-up time"
label(PFAS_A$race) <- "Race/Ethnicity"
label(PFAS_A$edu) <- "Education"
label(PFAS_A$bmi_cat) <- "Pre-pregnancy BMI"
label(PFAS_A$smoke) <- "Smoking status"
label(PFAS_A$income) <- "Annual household income"
label(PFAS_A$parity) <- "Parity"
label(PFAS_A$married) <- "Married or cohabitating"

##### ADD UNITS
units(PFAS_A$age_enroll)  <- "years"
units(PFAS_A$age_fu)  <- "years"
units(PFAS_A$fu_time)  <- "years"
units(PFAS_A$bmi_cat)  <- "kg/m2"

##### TABE 1
table1(~ age_enroll + age_fu + fu_time + race + bmi_cat + edu + income + parity + 
         smoke + married, data = PFAS_A, overall = "Total")

```

```{r}
##### ANTHRO + DXA DATASET #####

##### RENAME
PFAS_AD$age_enroll <- PFAS_AD$age_mom_enroll_d
PFAS_AD$age_fu <- (PFAS_AD$mom_age_days_mdxa17)/365
PFAS_AD$fu_time <- (PFAS_AD$age_days_mdxa17)/365
PFAS_AD$race <- PFAS_AD$race2_mom_epi_epia_d
PFAS_AD$edu <- PFAS_AD$coll_grad
PFAS_AD$bmi <- PFAS_AD$bmi_mom_prepreg_d
PFAS_AD$smoke <- PFAS_AD$smokpreg_final_d
PFAS_AD$income <- PFAS_AD$gt70k
PFAS_AD$parity <- PFAS_AD$parity_d
PFAS_A$married <- PFAS_A$married_cohab

##### RE-LABEL 
PFAS_AD$race <- ifelse(PFAS_AD$race == "white", 0,
                     ifelse(PFAS_AD$race == "black", 1,
                     ifelse(PFAS_AD$race == "hispa", 2,
                     ifelse(PFAS_AD$race == "asian", 3,
                     ifelse(PFAS_AD$race == "other", 4, 4)))))
PFAS_AD$edu <- ifelse(PFAS_AD$edu == 1, 1, 0)
PFAS_AD$bmi_cat <- ifelse(PFAS_AD$bmi <18.5, 0,
                         ifelse(PFAS_AD$bmi >=18.5 & PFAS_AD$bmi < 25.0, 1, 
                         ifelse(PFAS_AD$bmi >=25.0 & PFAS_AD$bmi < 30.0, 2, 
                         ifelse(PFAS_AD$bmi >=30.0 & PFAS_AD$bmi < 35.0, 3,
                         ifelse(PFAS_AD$bmi >=35.0, 4, 99)))))
PFAS_AD$smoke <- ifelse(PFAS_AD$smoke == "former", 0,
                         ifelse(PFAS_AD$smoke == "smoke preg", 1,
                         ifelse(PFAS_AD$smoke == "xnever", 2, 2)))
PFAS_AD$income <- ifelse(PFAS_AD$income == 1, 1, 0)
PFAS_AD$parity <- ifelse(PFAS_AD$parity == 0, 0,
                        ifelse(PFAS_AD$parity == 1, 1,
                        ifelse(PFAS_AD$parity > 1, 2, 0)))
PFAS_AD$married <- ifelse(PFAS_AD$married == 1, 1, 0)


##### REFACTOR
PFAS_AD$race <- factor(PFAS_AD$race,
                        levels = c(0, 1, 2, 3, 4),
                        labels = c("White", "Black", "Hispanic", "Asian", "Other/More than 1 race"))
PFAS_AD$edu <- factor(PFAS_AD$edu,
                       levels = c(0, 1),
                       labels = c(" < college degree", ">= college degree"))
PFAS_AD$bmi_cat <- factor(PFAS_AD$bmi_cat,
                       levels = c(0, 1, 2, 3, 4),
                       labels = c("Underweight (< 18.5)", "Normal weight (18.5 to 24.9)", 
                                  "Overweight (25.0 to 29.9)", "Obese (30.0 to 34.9)", 
                                  "Extremely obese (>= 35)"))
PFAS_AD$smoke <- factor(PFAS_AD$smoke,
                         levels = c(0, 1, 2),
                         labels = c("Former smoker", "Smoked during pregnancy", "Never smoked"))
PFAS_AD$income <- factor(PFAS_AD$income,
                       levels = c(0, 1),
                       labels = c(" <= $70,000", "> $70,000"))
PFAS_AD$parity <- factor(PFAS_AD$parity,
                          levels = c(0, 1, 2),
                          labels = c("0", "1", ">= 2"))
PFAS_AD$married <- factor(PFAS_AD$married,
                          levels = c(0, 1),
                          labels = c("No", "Yes"))

##### LABEL
label(PFAS_AD$age_enroll) <- "Maternal age at enrollment"
label(PFAS_AD$age_fu) <- "Maternal age at follow-up"
label(PFAS_AD$fu_time) <- "Follow-up time"
label(PFAS_AD$race) <- "Race/Ethnicity"
label(PFAS_AD$edu) <- "Education"
label(PFAS_AD$bmi_cat) <- "Pre-pregnancy BMI"
label(PFAS_AD$smoke) <- "Smoking status"
label(PFAS_AD$income) <- "Annual household income"
label(PFAS_AD$parity) <- "Parity"
label(PFAS_AD$married) <- "Married or cohabitating"

##### ADD UNITS
units(PFAS_AD$age_enroll)  <- "years"
units(PFAS_AD$age_fu)  <- "years"
units(PFAS_AD$fu_time)  <- "years"
units(PFAS_AD$bmi_cat)  <- "kg/m2"

##### TABE 1
table1(~ age_enroll + age_fu + fu_time + race + bmi_cat + edu + income + parity + 
         smoke + married, data = PFAS_AD, overall = "Total")

```

```{r}
##### EXCLUSION DATASET #####

##### RENAME
PFAS_X$age_enroll <- PFAS_X$age_mom_enroll_d
PFAS_X$race <- PFAS_X$race2_mom_epi_epia_d
PFAS_X$edu <- PFAS_X$coll_grad
PFAS_X$bmi <- PFAS_X$bmi_mom_prepreg_d
PFAS_X$smoke <- PFAS_X$smokpreg_final_d
PFAS_X$income <- PFAS_X$gt70k
PFAS_X$parity <- PFAS_X$pari_d
PFAS_A$married <- PFAS_A$married_cohab

##### RE-LABEL 
PFAS_X$race <- ifelse(PFAS_X$race == "white", 0,
                     ifelse(PFAS_X$race == "black", 1,
                     ifelse(PFAS_X$race == "hispa", 2,
                     ifelse(PFAS_X$race == "asian", 3,
                     ifelse(PFAS_X$race == "other", 4, 4)))))
PFAS_X$edu <- ifelse(PFAS_X$edu == 1, 1, 0)
PFAS_X$bmi_cat <- ifelse(PFAS_X$bmi <18.5, 0,
                         ifelse(PFAS_X$bmi >=18.5 & PFAS_X$bmi < 25.0, 1, 
                         ifelse(PFAS_X$bmi >=25.0 & PFAS_X$bmi < 30.0, 2, 
                         ifelse(PFAS_X$bmi >=30.0 & PFAS_X$bmi < 35.0, 3,
                         ifelse(PFAS_X$bmi >=35.0, 4, 99)))))
PFAS_X$smoke <- ifelse(PFAS_X$smoke == "former", 0,
                         ifelse(PFAS_X$smoke == "smoke preg", 1,
                         ifelse(PFAS_X$smoke == "xnever", 2, 2)))
PFAS_X$income <- ifelse(PFAS_X$income == 1, 1, 0)
PFAS_X$parity <- ifelse(PFAS_X$parity == 0, 0,
                        ifelse(PFAS_X$parity == 1, 1,
                        ifelse(PFAS_X$parity > 1, 2, 0)))
PFAS_X$married <- ifelse(PFAS_X$married == 1, 1, 0)


##### REFACTOR
PFAS_X$race <- factor(PFAS_X$race,
                        levels = c(0, 1, 2, 3, 4),
                        labels = c("White", "Black", "Hispanic", "Asian", "Other/More than 1 race"))
PFAS_X$edu <- factor(PFAS_X$edu,
                       levels = c(0, 1),
                       labels = c(" < college degree", ">= college degree"))
PFAS_X$bmi_cat <- factor(PFAS_X$bmi_cat,
                       levels = c(0, 1, 2, 3, 4),
                       labels = c("Underweight (< 18.5)", "Normal weight (18.5 to 24.9)", 
                                  "Overweight (25.0 to 29.9)", "Obese (30.0 to 34.9)", 
                                  "Extremely obese (>= 35)"))
PFAS_X$smoke <- factor(PFAS_X$smoke,
                         levels = c(0, 1, 2),
                         labels = c("Former smoker", "Smoked during pregnancy", "Never smoked"))
PFAS_X$income <- factor(PFAS_X$income,
                       levels = c(0, 1),
                       labels = c(" <= $70,000", "> $70,000"))
PFAS_X$parity <- factor(PFAS_X$parity,
                          levels = c(0, 1, 2),
                          labels = c("0", "1", ">= 2"))
PFAS_X$married <- factor(PFAS_X$married,
                          levels = c(0, 1),
                          labels = c("No", "Yes"))

##### LABEL
label(PFAS_X$age_enroll) <- "Maternal age at enrollment"
label(PFAS_X$race) <- "Race/Ethnicity"
label(PFAS_X$edu) <- "Education"
label(PFAS_X$bmi_cat) <- "Pre-pregnancy BMI"
label(PFAS_X$smoke) <- "Smoking status"
label(PFAS_X$income) <- "Annual household income"
label(PFAS_X$parity) <- "Parity"
label(PFAS_X$married) <- "Married or cohabitating"

##### ADD UNITS
units(PFAS_X$age_enroll)  <- "years"
units(PFAS_X$bmi_cat)  <- "kg/m2"

##### TABE 1
table1(~ age_enroll + race + bmi_cat + edu + income + parity + 
         smoke + married, data = PFAS_X, overall = "Total")

```

```{r}
##### ANTHRO DATASET #####

##### PFAS DISTRIBUTION TABLE
summary(PFAS_A$PFOS)
summary(PFAS_A$PFOA)
summary(PFAS_A$PFNA2)
summary(PFAS_A$PFHxS)
summary(PFAS_A$Me_PFOSA_AcOH2)
summary(PFAS_A$Et_PFOSA_AcOH)

# RENAME PFAS FOR THE PLOT
colnames(PFAS_A)[colnames(PFAS_A) == "Me_PFOSA_AcOH2"] <- "MeFOSSA"
colnames(PFAS_A)[colnames(PFAS_A) == "Et_PFOSA_AcOH"] <- "EtFOSSA"
colnames(PFAS_A)[colnames(PFAS_A) == "PFNA2"] <- "PFNA"

##### PFAS CORRELATION MATRIX
PFAS_A_corr <- PFAS_A[ , c("PFOS", "PFOA", "PFNA", "PFHxS", "MeFOSSA", "EtFOSSA")]
p_corr <- cor(PFAS_A_corr)
round(p_corr, 2)

corrplot(p_corr, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 45)

```

```{r}
##### ANTHRO + DXA DATASET #####

##### PFAS DISTRIBUTION TABLE
summary(PFAS_AD$PFOS)
summary(PFAS_AD$PFOA)
summary(PFAS_AD$PFNA2)
summary(PFAS_AD$PFHxS)
summary(PFAS_AD$Me_PFOSA_AcOH2)
summary(PFAS_AD$Et_PFOSA_AcOH)

# RENAME PFAS FOR THE PLOT
colnames(PFAS_AD)[colnames(PFAS_AD) == "Me_PFOSA_AcOH2"] <- "MeFOSSA"
colnames(PFAS_AD)[colnames(PFAS_AD) == "Et_PFOSA_AcOH"] <- "EtFOSSA"
colnames(PFAS_AD)[colnames(PFAS_AD) == "PFNA2"] <- "PFNA"

##### PFAS CORRELATION MATRIX
PFAS_AD_corr <- PFAS_AD[ , c("PFOS", "PFOA", "PFNA", "PFHxS", "MeFOSSA", "EtFOSSA")]
p_corr <- cor(PFAS_AD_corr)
round(p_corr, 2)

corrplot(p_corr, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 45)


```

```{r}
##### ANTHRO DATASET #####

##### OUTCOMES DISTRIBUTION TABLE
summary(PFAS_A$mom_bmi_MT)
summary(PFAS_A$mom_weight_ma17)
summary(PFAS_A$mom_waist_ma17)
summary(PFAS_A$mom_hip_ma17)
summary(PFAS_A$mom_bodyfat_ma17)
summary(PFAS_A$mom_fat_ma17)

# RENAME PFAS FOR THE PLOT
colnames(PFAS_A)[colnames(PFAS_A) == "mom_bmi_MT"] <- "BMI"
colnames(PFAS_A)[colnames(PFAS_A) == "mom_waist_ma17"] <- "Waist"
colnames(PFAS_A)[colnames(PFAS_A) == "mom_hip_ma17"] <- "Hip"
colnames(PFAS_A)[colnames(PFAS_A) == "mom_bodyfat_ma17"] <- "FatPct"
colnames(PFAS_A)[colnames(PFAS_A) == "mom_fat_ma17"] <- "FatMass"
colnames(PFAS_A)[colnames(PFAS_A) == "mom_weight_ma17"] <- "Weight"

##### OUTCOMES CORRELATION MATRIX
OUTCOMES_A_corr <- PFAS_A[ , c("BMI", "Waist", "Hip", "FatPct", "FatMass", "Weight")]
o_A_corr <- cor(OUTCOMES_A_corr)
round(o_A_corr, 2)

corrplot(o_A_corr, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 45)

corrplot.mixed(cor(o_A_corr),
               upper = "circle",
               tl.col = "black")

```

```{r}
##### ANTHRO + DXA DATASET #####

##### OUTCOMES DISTRIBUTION TABLE
summary(PFAS_AD$VAT_AREA_mdxa17)
summary(PFAS_AD$SAT_AREA_mdxa17)
summary(PFAS_AD$TAT_AREA_mdxa17)
summary(PFAS_AD$VAT_MASS_mdxa17)
summary(PFAS_AD$SAT_MASS_mdxa17)
summary(PFAS_AD$TAT_MASS_mdxa17)
summary(PFAS_AD$VAT_VOLUME_mdxa17)
summary(PFAS_AD$SAT_VOLUME_mdxa17)
summary(PFAS_AD$TAT_VOLUME_mdxa17)
summary(PFAS_AD$mom_bmi_MT)
summary(PFAS_AD$mom_weight_ma17)
summary(PFAS_AD$mom_waist_ma17)
summary(PFAS_AD$mom_hip_ma17)
summary(PFAS_AD$mom_bodyfat_ma17)
summary(PFAS_AD$mom_fat_ma17)

# RENAME PFAS FOR THE PLOT
colnames(PFAS_AD)[colnames(PFAS_AD) == "VAT_AREA_mdxa17"] <- "VT area"
colnames(PFAS_AD)[colnames(PFAS_AD) == "SAT_AREA_mdxa17"] <- "ST area"
colnames(PFAS_AD)[colnames(PFAS_AD) == "TAT_AREA_mdxa17"] <- "TT area"
colnames(PFAS_AD)[colnames(PFAS_AD) == "VAT_VOLUME_mdxa17"] <- "VT vol"
colnames(PFAS_AD)[colnames(PFAS_AD) == "SAT_VOLUME_mdxa17"] <- "ST vol"
colnames(PFAS_AD)[colnames(PFAS_AD) == "TAT_VOLUME_mdxa17"] <- "TT vol"
colnames(PFAS_AD)[colnames(PFAS_AD) == "VAT_MASS_mdxa17"] <- "VT mass"
colnames(PFAS_AD)[colnames(PFAS_AD) == "SAT_MASS_mdxa17"] <- "ST mass"
colnames(PFAS_AD)[colnames(PFAS_AD) == "TAT_MASS_mdxa17"] <- "TT mass"
colnames(PFAS_AD)[colnames(PFAS_AD) == "mom_bmi_MT"] <- "BMI"
colnames(PFAS_AD)[colnames(PFAS_AD) == "mom_weight_ma17"] <- "Weight"
colnames(PFAS_AD)[colnames(PFAS_AD) == "mom_waist_ma17"] <- "Waist"
colnames(PFAS_AD)[colnames(PFAS_AD) == "mom_hip_ma17"] <- "Hip"
colnames(PFAS_AD)[colnames(PFAS_AD) == "mom_bodyfat_ma17"] <- "FatPct"
colnames(PFAS_AD)[colnames(PFAS_AD) == "mom_fat_ma17"] <- "FatMass"

##### OUTCOMES CORRELATION MATRIX
OUTCOMES_AD_corr <- PFAS_AD[ , c("VT area", "ST area", "TT area", "VT vol", "ST vol", 
                               "TT vol", "VT mass", "ST mass", "TT mass", "BMI", 
                               "Weight", "Waist", "Hip", "FatPct", "FatMass")]
o_AD_corr <- cor(OUTCOMES_AD_corr)
round(o_AD_corr, 2)

corrplot(o_AD_corr, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 45)

corrplot.mixed(cor(o_AD_corr),
               upper = "circle",
               tl.col = "black")

```

```{r}
##### SAVE DATASET
write.csv(PFAS_A, file = "C:/Users/jarva/Desktop/James-Todd Lab/PFASandAdiposity/Data/PFAS_A.csv", row.names = T)
write.csv(PFAS_AD, file = "C:/Users/jarva/Desktop/James-Todd Lab/PFASandAdiposity/Data/PFAS_AD.csv", row.names = T)

```
